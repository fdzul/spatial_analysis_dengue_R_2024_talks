---
format: 
  revealjs:
    code-block-bg: true
    code-block-background: true
    code-copy: true
    chalkboard: true
    highlight-style: github
    slide-number: c/t
    logo: logo_cenaprece.jpeg
    footer: "[hub.com/fdzul](https://github.com/fdzul)"
    center-title-slide: true
---

<h2>Modelo Estratégico de Focalización
<br>del Dengue México
</h2>

<h2>

</h2>

<hr>

<br>


<h3>Dr. Felipe Dzul Manzanilla</h3>

<h3>Dr. Fabián Correa-Morales</h3>

<h3>

</h3>
<br>
<h4>Date: 2024-02-07 </h4>

<h4> Update: 2024-02-07</h4>

<br>

<h4>


![](logo_curso_2024.png){.absolute top="170" left="650" width="450"}



## [Definición de los Escenarios Operativos ó Epidemiológicos]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

:::: {.columns}

::: {.column style="width: 40%;font-size: 70%"}

<span style="color:#F44B1FFF;">Áreas con riesgo muy alto de transmisión.</span> Hotposts de casos + hotspots del vector.

<span style="color:#FF9000FF;">Áreas con riesgo alto de transmisión.</span> Hotspots de transmisión.

<span style="color:gold;">Áreas con riesgo medio de transmisión.</span>Hotspots del vector.

<span style="color:#00F293FF;">Áreas con riesgo alto de transmisión.</span>Sin hotspots de transmisión o hotspots del vector.


:::

::: {.column style="width: 60%"}

:::

::::


## [Localidades sin Transmision Epidémica en el Primer Semestre]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Step 1. load the dataset #####
load("/Users/fdzul/Library/CloudStorage/OneDrive-Personal/automatic_read_sinave/8.RData/epid_channel_data.RData")

# Step 2. extract the dengue cases of veracruz ####
x <- x |>
    dplyr::filter(DES_EDO_RES == "VERACRUZ") 

y <- tibble::tibble(SEM = x$SEM,
                    y = x$q25,
                    arm = "Nuevo Paradigma")
prob <- tibble::tibble(SEM = x$SEM,
                       prob = rep(0, length(x$SEM)))

# plot risk stratificaction  #####
ggplot2::ggplot() +
    ggplot2::geom_rect(ggplot2::aes(xmin = c(-Inf, 25), 
                                    xmax = c(25, Inf), 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = c("#2EB67D", "#2EB67D"),
                       alpha = .2) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 20, 
                                    xmax = 25, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "orange",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 25, 
                                    xmax = 27, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "gray40",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 38, 
                                    xmax = 40, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "#E01E5A",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 40, 
                                    xmax = 42, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "gray40",
                       alpha = 0.8) +
    ggplot2::geom_vline(xintercept = 25,
                        color = "gray", #"#36C5F0",
                        size = 1,
                        linetype = 3) +
    ggplot2::geom_vline(xintercept = 20,
                        color = "gray40", #"#36C5F0",
                        size = 1,
                        linetype = 3) +
    ggplot2::geom_line(data = y, 
                       ggplot2::aes(x = SEM,
                                    y = y),
                       color = "#2EB67D", #"#36C5F0",
                       size = 3) +
    ggplot2::scale_x_continuous(breaks = seq(from = min(y$SEM), to = max(y$SEM), by = 4))+
    ggplot2::ylab("Número de Casos") +
    ggplot2::xlab("Semanas Epidemiológicas") +
    ggplot2::annotate("text",
                      label = "Control Proactivo",
                      x = 10, 
                      y = 450,
                      #text = "risk",
                      col = "#2EB67D",
                      size = 6) +
    ggplot2::annotate("text",
                      label = "Escenarios Operativos \nbasados \nen \nTransmisión Persistente",
                      x = 10, 
                      y = 380,
                      #text = "risk",
                      col = "#2EB67D",
                      size = 4) +
    ggplot2::geom_line(data = prob, 
                       ggplot2::aes(x = SEM,
                                    y = prob),
                       color = "#36C5F0",
                       size = 2)  +
    ggplot2::annotate("text",
                      label = "Acciones Específicas Básicas",
                      x = 10, 
                      y = 280,
                      col = "gray40",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Vigilancia Epidemiológica y Entomológica",
                      x = 10, 
                      y = 250,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Control de Probables",
                      x = 10, 
                      y = 230,
                      col = "#36C5F0",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "Hotspots del Vector",
                      x = 10, 
                      y = 200,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Acciones Específicas de Soporte",
                      x = 10, 
                      y = 150,
                      col = "gray40",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Termonebulización,\n Nebulización, & \nEliminación Masiva de Criaderos",
                      x = 10, 
                      y = 110,
                      col = "gray40",
                      size = 3) +
  ggplot2::annotate("text",
                      label = "Con Control",
                      x = 35, 
                      y = 105,
                      col = "#2EB67D",
                      size = 4) +
  ggplot2::annotate(geom ="text",
                      label = "Rociado Residual Intradomiciliario & Control Larvario",
                      x = 22, 
                      y = 220,
                    angle = 90,
                      col = "white",
                      size = 4) +
    ggplot2::annotate(geom ="text",
                      label = "ULV Fria o Caliente",
                      x = 26, 
                      y = 220,
                      angle = 90,
                      col = "white",
                      size = 4) +
  ggplot2::annotate(geom ="text",
                      label = "Control Larvario",
                      x = 39, 
                      y = 220,
                    angle = 90,
                      col = "white",
                      size = 4) +
    ggplot2::annotate(geom ="text",
                      label = "ULV Fria o Caliente",
                      x = 41, 
                      y = 220,
                      angle = 90,
                      col = "white",
                      size = 4)

```


## [Localidades con Transmision Epidémica en el Segundo Semestre]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">


```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Step 1. load the dataset #####
load("/Users/fdzul/Library/CloudStorage/OneDrive-Personal/automatic_read_sinave/8.RData/epid_channel_data.RData")

# Step 2. extract the dengue cases of veracruz ####
x <- x |>
    dplyr::filter(DES_EDO_RES == "VERACRUZ") 

y <- tibble::tibble(SEM = x$SEM,
                    y = x$q25,
                    arm = "Nuevo Paradigma")
prob <- tibble::tibble(SEM = x$SEM,
                       prob = rep(0, length(x$SEM)))

# plot risk stratificaction  #####
ggplot2::ggplot() +
    ggplot2::geom_rect(ggplot2::aes(xmin = c(-Inf, 25), 
                                    xmax = c(25, Inf), 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = c("#2EB67D", "#E01E5A"),
                       alpha = .2) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 20, 
                                    xmax = 25, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "orange",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 25, 
                                    xmax = 27, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "gray40",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 38, 
                                    xmax = 40, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "#E01E5A",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 40, 
                                    xmax = 42, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "gray40",
                       alpha = 0.8) +
    ggplot2::geom_vline(xintercept = 25,
                        color = "gray40", #"#36C5F0",
                        size = 1,
                        linetype = 3) +
    ggplot2::geom_vline(xintercept = 20,
                        color = "gray40", #"#36C5F0",
                        size = 1,
                        linetype = 3) +
    ggplot2::geom_line(data = x, 
                       ggplot2::aes(x = SEM,
                                    y = q75-10),
                       col = "#E01E5A",
                       size = 3) +
    ggplot2::scale_x_continuous(breaks = seq(from = min(y$SEM), to = max(y$SEM), by = 4))+
    ggplot2::ylab("Número de Casos") +
    ggplot2::xlab("Semanas Epidemiológicas") +
    ggplot2::annotate("text",
                      label = "Control Proactivo",
                      x = 10, 
                      y = 450,
                      #text = "risk",
                      col = "#2EB67D",
                      size = 6) +
    ggplot2::annotate("text",
                      label = "Escenarios Operativos \nbasados \nen \nTransmisión Persistente",
                      x = 10, 
                      y = 380,
                      #text = "risk",
                      col = "#2EB67D",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Control Reactivo",
                      x = 47, 
                      y = 450,
                      #text = "risk",
                      col = "#E01E5A",
                      size = 6) +
    ggplot2::annotate("text",
                      label = "Escenarios Operativos \nbasados \nen \nTransmisión Activa",
                      x = 47, 
                      y = 380,
                      #text = "risk",
                      col = "#E01E5A",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Acciones Específicas Básicas",
                      x = 10, 
                      y = 280,
                      col = "gray40",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Vigilancia Epidemiológica y Entomológica",
                      x = 10, 
                      y = 250,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Control de Probables",
                      x = 10, 
                      y = 230,
                      col = "#36C5F0",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "Hotspots del Vector",
                      x = 10, 
                      y = 200,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Acciones Específicas de Soporte",
                      x = 10, 
                      y = 150,
                      col = "gray40",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Termonebulización,\n Nebulización, & \nEliminación Masiva de Criaderos",
                      x = 10, 
                      y = 110,
                      col = "gray40",
                      size = 3) +
  ggplot2::annotate(geom ="text",
                      label = "Rociado Residual Intradomiciliario & Control Larvario",
                      x = 22, 
                      y = 220,
                    angle = 90,
                      col = "white",
                      size = 4) +
    ggplot2::annotate(geom ="text",
                      label = "ULV Fria o Caliente",
                      x = 26, 
                      y = 220,
                      angle = 90,
                      col = "white",
                      size = 4) +
  ggplot2::annotate(geom ="text",
                      label = "Control Larvario",
                      x = 39, 
                      y = 220,
                    angle = 90,
                      col = "white",
                      size = 4) +
    ggplot2::annotate(geom ="text",
                      label = "ULV Fria o Caliente",
                      x = 41, 
                      y = 220,
                      angle = 90,
                      col = "white",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "1. MegaOperativos o Barrido",
                      x = 33, 
                      y = 150,
                      col = "Black",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "ULV (4S)",
                      x = 32, 
                      y = 130,
                      col = "#E01E5A",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "Control Larvario",
                      x = 32, 
                      y = 110,
                      col = "#E01E5A",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "2. Operativo Focalizado",
                      x = 49, 
                      y = 300,
                      col = "black",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "Termo (4S) Alto Riesgo",
                      x = 49, 
                      y = 280,
                      col = "#E01E5A",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "Termo SCM",
                      x = 49, 
                      y = 260,
                      col = "#E01E5A",
                      size = 4)

```


## [Localidades con Transmision Epidémica en el Primer Semestre]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

```{r}
load("/Users/fdzul/Library/CloudStorage/OneDrive-Personal/automatic_read_sinave/8.RData/epid_channel_data.RData")

# Step 2. extract the dengue cases of veracruz ####
x <- x |>
    dplyr::filter(DES_EDO_RES == "VERACRUZ") 

y <- tibble::tibble(SEM = x$SEM,
                    y = x$q25,
                    arm = "Nuevo Paradigma")
#prob <- tibble::tibble(SEM = x$SEM,
#                       prob = rep(0, length(x$SEM)))


sim_a <- x |>
    dplyr::filter(SEM >= 26) |>
    dplyr::arrange(SEM) |>
    dplyr::mutate(sem = 1:28) |>
    dplyr::select(sem, q75)
sim_b <- tibble::tibble(sem = 28:53,
                        q75 = rnorm(n = length(28:53),
                                  mean = 29,
                                  sd = 1))

# plot risk stratificaction  #####
ggplot2::ggplot() +
    ggplot2::geom_rect(ggplot2::aes(xmin = c(-Inf, 25), 
                                    xmax = c(25, Inf), 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = c("#E01E5A", "#2EB67D"),
                       alpha = .2) +
    ggplot2::geom_line(data = sim_a, 
                       ggplot2::aes(x = sem,
                                    y = q75-10),
                       col = "#E01E5A",
                       size = 3) +
    ggplot2::geom_line(data = sim_b, 
                       ggplot2::aes(x = sem,
                                    y = q75-10),
                       col = "#2EB67D",
                       size = 3) +
    ggplot2::scale_x_continuous(breaks = seq(from = min(y$SEM),
                                             to = max(y$SEM), 
                                             by = 4)) +
    ggplot2::ylab("Número de Casos") +
    ggplot2::xlab("Semanas Epidemiológicas") +
    ggplot2::annotate("text",
                      label = "Control Proactivo",
                      x = 40, 
                      y = 450,
                      #text = "risk",
                      col = "#2EB67D",
                      size = 6) +
    ggplot2::annotate("text",
                      label = "Control Reactivo",
                      x = 10, 
                      y = 450,
                      #text = "risk",
                      col = "#E01E5A",
                      size = 6) +
    ggplot2::annotate("text",
                      label = "Acciones Específicas Básicas",
                      x = 40, 
                      y = 310,
                      col = "gray40",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Vigilancia Epidemiológica y Entomológica",
                      x = 25, 
                      y = 400,
                      col = "black",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Control de Probables",
                      x = 40, 
                      y = 280,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Áreas de riesgo",
                      x = 40, 
                      y = 240,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Hotspots del Vector",
                      x = 40, 
                      y = 260,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "1. MegaOperativos o Barridos",
                      x = 12, 
                      y = 200,
                      col = "Black",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "ULV (4S)",
                      x = 10, 
                      y = 180,
                      col = "#E01E5A",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Control Larvario (4S-6S)",
                      x = 10, 
                      y = 160,
                      col = "#E01E5A",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "2. Operativo Focalizado",
                      x = 10, 
                      y = 100,
                      col = "black",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Termo (4S) Alto Riesgo",
                      x = 10, 
                      y = 80,
                      col = "#E01E5A",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Termo SCM",
                      x = 10, 
                      y = 60,
                      col = "#E01E5A",
                      size = 4)
```

