---
format: 
  revealjs:
    code-block-bg: true
    code-block-background: true
    code-copy: true
    chalkboard: true
    highlight-style: github
    slide-number: c/t
    logo: logo_cenaprece.jpeg
    footer: "[hub.com/fdzul](https://github.com/fdzul)"
    center-title-slide: true
---

<h2>Modelo Estratégico de Focalización
<br>del Dengue México
</h2>

<h2>

</h2>

<hr>

<br>


<h3>Dr. Felipe Dzul Manzanilla</h3>

<h3>Dr. Fabián Correa-Morales</h3>

<h3>

</h3>
<br>
<h4> Created: 2024-02-07 </h4>

<h4> Updated: 2024-02-12</h4>

<h4> Compiled: 2024-02-19</h4>

<br>

<h4>


![](logo_curso_2024.png){.absolute top="170" left="650" width="450"}


## [Temario]{style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

- Manejo Integrado de los Vectores (MIA)
- MIA de las arbovirosis
- MIA del Dengue en Asia
- Estratificación del Dengue a nivel de Localidades
- Estratificación del Dengue a nivel de ciudad
- Escenarios Operativos basados en Transmisión y abundancia Persistente 
- Definición de los Escenarios Operativos de la Transmisión Persistente


## [Temario]{style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

- Escenarios Operativos basados en Transmisión Activa y Abundancia Reciente
- Definición de los Escenarios Operativos de la Transmisión Reciente
- Biología del Vector
- Manejo Integrado de los Arbovirosis en México
- Directrices Internacionales

## [Manejo Integrado de los Vectores]{style="color:#003300"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

![](def_mia.png)

## [Manejo Integrado de Aedes]{style="color:#003300"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

![](https://journals.plos.org/plosntds/article/figure/image?size=large&id=10.1371/journal.pntd.0006845.g001){.absolute top="100" width="800" height="550" right="120"}

## [MIA y Escenarios Operativos en Asia]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

![](IRS_WPR2.png)

## [MIA y Escenarios Operativos en América]{.r-fit-text .center style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

![](mia_paho.png)

## [Estratificación del Dengue a nivel de Localidades]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

```{r}
DiagrammeR::grViz("digraph {
                  # graph definitions
  graph [layout = dot, rankdir = TB]
  
  # node definitions
  node [shape = rectangle, style = filled, color = grey, 
  nodesep = 1, 
  fixedsize = false, 
  width = 1.7] 
  
  # edge definition
  edge [color = grey, arrowhead = normal, arrowtail = dot]
  
  ##### fuentes de información
  
  inf [label = 'Bases de Datos',  fillcolor =  '#DB4437', color = 'white', fontcolor = 'white']
  
  
  ##### datasets
  
  ento [label = 'Vigilancia Entomológica',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
  epi [label = 'Vigilancia Epidemiológica',  fillcolor =  ' #0F9D58', color = 'white', fontcolor = 'white']
  clim [label = 'Datos Clímaticos',  fillcolor =  ' #0F9D58', color = 'white', fontcolor = 'white']
  socio [label = 'Datos Sociodemográficos',  fillcolor =  ' #0F9D58', color = 'white', fontcolor = 'white']
  land [label = 'Cobertura Terrestre',  fillcolor =  ' #0F9D58', color = 'white', fontcolor = 'white']
  mov [label = 'Datos de Movilidad',  fillcolor =  ' #0F9D58', color = 'white', fontcolor = 'white']
 
 ### 
 ana [label = 'Estadística Multivariada',  fillcolor =  'orange', color = 'white', fontcolor = 'black']
 
 ### 
 indice [label = 'Indice de Riesgo',  fillcolor =  'DodgerBlue', color = 'white', fontcolor = 'white']
 
 ###
 hotspots [label = 'Hotspots',  fillcolor =  '#E01E5A', color = 'white', fontcolor = 'white']
 
 ##### define the relation
 
 inf -> {ento, epi, clim, socio, land, mov} -> ana -> indice -> hotspots
 
 
}")
```


## [Estratificación del Dengue a nivel de Localidades]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">


```{r  echo=FALSE, warning=FALSE, message=FALSE}

DiagrammeR::grViz("digraph {
                  
  # graph definitions
  graph [layout = dot, rankdir = TB]
  
  
   # node definitions
  node [shape = rectangle, 
  style = filled, 
  color = grey, 
  nodesep = 0.1,
  fixedsize = true, 
  width = 2.5]
  
  
  # edge definition
  edge [color = grey, arrowhead = normal, arrowtail = dot]
  
  ##### epidemiological data
  
  localidad [label = 'Localidad',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
  
  loc_endemica [label = 'Endémica',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
  loc_no_endemica [label = 'No Endémica',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
  
  
  sin_trans [label = 'Sin Transmisión',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
  con_trans [label = 'Con Transmisión',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
  
  trans_epi [label = 'Epidémica',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
  trans_no_epi [label = 'No Epidémica',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
  
  todo [label = 'Todo El Año',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
  segundo_semestre [label = 'Segundo Semetre',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
  primer_semestre [label = 'Primer Semestre',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
 
  node [shape = circle,
        fixedsize = true,
        width = .9]
  A [label = 'A',  fillcolor =  'orange', color = 'white', fontcolor = 'black']
  B [label = 'B',  fillcolor =  'orange', color = 'white', fontcolor = 'black']
  C [label = 'C',  fillcolor =  'orange', color = 'white', fontcolor = 'black']
  D [label = 'D',  fillcolor =  'orange', color = 'white', fontcolor = 'black']
  E [label = 'E',  fillcolor =  'orange', color = 'white', fontcolor = 'black']
 
  
  localidad -> {loc_no_endemica loc_endemica}
  loc_endemica -> {sin_trans con_trans}
  con_trans -> {trans_epi trans_no_epi}
  
  trans_epi -> {todo, segundo_semestre primer_semestre}
  
  sin_trans -> A
  trans_no_epi -> B
  todo -> E
  primer_semestre -> C
  segundo_semestre -> D
  
  
}")

```


## [Estratificación del Dengue a nivel de Ciudad]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

```{r}
# Propuesta ####
DiagrammeR::grViz("digraph {
                  # graph definitions
  graph [layout = dot, rankdir = TB]
  
  # node definitions
  node [shape = rectangle, 
  style = filled, 
  color = grey, 
  nodesep = .5,
  fixedsize = true, 
  width = 5.2]
  
  
  # edge definition
  edge [color = grey, arrowhead = normal, arrowtail = dot]
  
  ##### epidemiological data
  
  epi [label = 'Vigilancia Epidemiológica',  fillcolor =  '#682D63', color = 'white', fontcolor = 'white']
  ento [label = 'Vigilancia Entomológica',  fillcolor =  '#682D63', color = 'white', fontcolor = 'white']
  
  
  node [shape = rectangle, 
  style = filled, 
  color = grey, 
  nodesep = .5,
  fixedsize = true, 
  width = 2.5]
  
  
  
  data_historic [label = 'Datos Históricos',  fillcolor =  'gray', color = 'white', fontcolor = 'black']
  datos_actuales [label = 'Datos Recientes',  fillcolor =  'gray', color = 'white', fontcolor = 'black']
  
  
  ##### entomologica data
  ovis_historic [label = 'Datos Históricos',  fillcolor =  'gray', color = 'white', fontcolor = 'black']
  ovis_actuales [label = 'Datos Recientes',  fillcolor =  'gray', color = 'white', fontcolor = 'black']
  
  
  
  ##### transmision
  
  trans_persistente [label = 'Transmisión Persistente',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
  trans_activa [label = 'Transmisión Activa',  fillcolor =  ' #0F9D58', color = 'white', fontcolor = 'white']
  
  abun_persistente1 [label = 'Abundancia Persistente',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
  abun_persistente2 [label = 'Abundancia Reciente',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']

  
  
  analisis_espacial1 [label = 'Análisis Espacial',  fillcolor =  'gray', color = 'white', fontcolor = 'black']
  analisis_espacial2 [label = 'Análisis Espacial',  fillcolor =  'gray', color = 'white', fontcolor = 'black']
  analisis_espacial3 [label = 'Análisis Espacial',  fillcolor =  'gray', color = 'white', fontcolor = 'black']
  analisis_espacial4 [label = 'Análisis Espacial',  fillcolor =  'gray', color = 'white', fontcolor = 'black']
  

 # Spatial data
 
 datos_espaciales1 [label = 'Datos Espaciales',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
 datos_espaciales2 [label = 'Datos Espaciales',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
 datos_espaciales3 [label = 'Datos Espaciales',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
 datos_espaciales4 [label = 'Datos Espaciales',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
 
 
 
 areal_data [label = 'Areal Data',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
 pp_data [label = 'Point Pattern Data',  fillcolor =  ' #0F9D58', color = 'white', fontcolor = 'white']
 geo_data1 [label = 'Geostatistical Data',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
 geo_data2 [label = 'Geostatistical Data',  fillcolor =  '#0F9D58', color = 'white', fontcolor = 'white']
     
 
 # Análisis 
 
 g_star [label = 'Getis & Ord Statistics',  fillcolor =  'orange', color = 'white', fontcolor = 'black']
 hotspots [label = 'Hotspots',  fillcolor =  'orange', color = 'white', fontcolor = 'black']
 knox [label = 'Knox Test',  fillcolor =  'orange', color = 'white', fontcolor = 'black']
 cadenas [label = 'Cadenas de Transmisión',  fillcolor =  'orange', color = 'white', fontcolor = 'black']
 
inla1 [label = 'SPDE-INLA',  fillcolor =  'orange', color = 'white', fontcolor = 'black']
 
hotspots2 [label = 'Hotspots',  fillcolor =  'orange', color = 'white', fontcolor = 'black']


inla2 [label = 'SPDE-INLA',  fillcolor =  'orange', color = 'white', fontcolor = 'black']
hotspots3 [label = 'Hotspots',  fillcolor =  'orange', color = 'white', fontcolor = 'black']

 
 # escenarios
node [shape = rectangle, 
  style = filled, 
  color = grey, 
  nodesep = .5,
  fixedsize = true, 
  width = 10.8]
risk [label = 'Escenarios Operativos ó Epidemiológicos',  fillcolor =  '#0E7C7B', color = 'white', fontcolor = 'white']
acciones [label = 'Acciones de Prevención y Control',  fillcolor =  '#0E7C7B', color = 'white', fontcolor = 'white']

node [shape = rectangle, 
  style = filled, 
  color = grey, 
  nodesep = .5,
  fixedsize = false, 
  width = 5.3]
fase1 [label = 'Fase I',  fillcolor =  '#17BEBB', color = 'white', fontcolor = 'black']
fase2 [label = 'Fase II',  fillcolor =  '#17BEBB', color = 'white', fontcolor = 'black']

risk2 [label = 'Transmisión Persistente & Abundancia Persistente',  fillcolor =  '#880044', color = 'white', fontcolor = 'white']
risk3 [label = 'Transmisión Activa & Abundancia Reciente',  fillcolor =  '#88004', color = 'white', fontcolor = 'white']

# escenarios
node [shape = rectangle, 
  style = filled, 
  color = grey, 
  nodesep = .5,
  fixedsize = true, 
  width = 10.8]
 fase3 [label = 'Fase III',  fillcolor =  '#17BEBB', color = 'white', fontcolor = 'black']



#
node [shape = rectangle, 
  style = filled, 
  color = grey, 
  nodesep = .2,
  fixedsize = true, 
  width = 1.1]

bajo1 [label = 'Bajo',  fillcolor =  '#36C5F0', color = 'white', fontcolor = 'black']
medio1 [label = 'Medio',  fillcolor =  '#2EB67D', color = 'white', fontcolor = 'black']
alto1 [label = 'Alto',  fillcolor =  '#ECB22E', color = 'white', fontcolor = 'black']
altisimo1 [label = 'Altisimo',  fillcolor =  '#E01E5A', color = 'white', fontcolor = 'white']

bajo2 [label = 'Bajo',  fillcolor =  '#36C5F0', color = 'white', fontcolor = 'black']
medio2 [label = 'Medio',  fillcolor =  '#2EB67D', color = 'white', fontcolor = 'black']
alto2 [label = 'Alto',  fillcolor =  '#ECB22E', color = 'white', fontcolor = 'black']
altisimo2 [label = 'Altisimo',  fillcolor =  '#E01E5A', color = 'white', fontcolor = 'white']


 ##### define the relation
 
 epi -> {data_historic  datos_actuales}
 data_historic -> trans_persistente -> analisis_espacial1 -> datos_espaciales1
 datos_actuales -> trans_activa -> analisis_espacial2 -> datos_espaciales2
 

 datos_espaciales1 -> areal_data -> g_star -> hotspots 
 datos_espaciales2 -> pp_data -> knox -> cadenas 
 
 ento -> {ovis_historic  ovis_actuales} 
 ovis_historic -> abun_persistente1 -> analisis_espacial3 -> datos_espaciales3 -> geo_data1
 ovis_actuales -> abun_persistente2 -> analisis_espacial4 -> datos_espaciales4 -> geo_data2
 geo_data1 -> inla1 -> hotspots2
 geo_data2 -> inla2 -> hotspots3

##
{hotspots, cadenas, hotspots2 hotspots3} -> risk -> {fase1 fase2}

fase1 -> risk2
fase2 -> risk3
risk2 -> {bajo1, medio1 alto1 altisimo1} -> fase3 
risk3 -> {bajo2, medio2 alto2 altisimo2} -> fase3 -> acciones

}")

```


## [Transmisión Persistente & Abundancia Persistente]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

<html>
<head>
```{=html}
<style>
.grid-container {
  display: grid;
  grid-template-columns: auto auto auto auto;
  padding: 5px;
}

.grid-item {
  background-color: rgba(255, 255, 255, 0.8);
  border: 1px solid rgba(0, 0, 0, 0.8);
  padding: 5px;
  font-size: 30px;
  text-align: center;
}
</style>
```
</head>
<body>
<h1>
</h1>
<p>
</p>

::: grid-container

::: grid-item
Localidad
:::

::: grid-item
Transmisión
:::

::: grid-item
Vector
:::

::: grid-item
Escenarios
:::

::: grid-item
Mérida
:::

::: grid-item
```{r hotspots_cases_merida, out.height="110%", out.width="110%"}
# Step 1. extract the locality ####
loc <- rgeomex::extract_locality(cve_edo = "31", 
                                 locality = "Merida")

# Step 2. Extract the hotspots ####
hotspots <- denmex::den_hotspots[loc, ]

# Step 3. Vizualization of hotspots ####

hotspots |>
    denhotspots::staticmap_intensity(pal = rcartocolor::carto_pal,
                                 pal_name = TRUE,
                                 name = "OrYel",
                                 breaks = 1,
                                 dir_pal = -1,
                                 x_leg = 0.5,
                                 y_leg = 0.1,
                                 ageb = TRUE)
```
:::

::: grid-item
```{r hotspots_vector_merida, out.height="110%", out.width="110%"}
source("/Users/fdzul/Dropbox/r_developments/r_talks/2023/reunion_interstatal_2023/reunion_quintana_roo/functions/intensity_eggs.R")

denmex::eggs_betas_31_yucatan |>
    dplyr::filter(year == 2019) |>
    intensity_eggs(locality = "Mérida",
                    cve_ent = "31",
                    palette = rcartocolor::carto_pal,
                    name = "SunsetDark")



```
:::

::: grid-item
```{r risk_merida, out.height="110%", out.width="110%"}
# Step 1. calculate the risk ####
risk <- denhotspots::risk_ageb(betas = denmex::eggs_betas_31_yucatan,
                               hotspots = denmex::den_hotspots,
                               intensity_perc = 25,
                               locality = "Mérida",
                               cve_edo = "31")

# Step 2. map ####
denhotspots::map_risk(risk = risk,
                      staticmap = TRUE)
```
:::

::: grid-item
Guadalajara
:::

::: grid-item
```{r hotspots_cases_guadalajara, out.height="110%", out.width="110%"}
# Step 1. extract the locality ####
loc <- rgeomex::extract_locality(cve_edo = "14", 
                                 locality = c("Guadalajara",
                                              "Tlaquepaque",
                                              "Tonalá",
                                              "Zapopan"))

# Step 2. Extract the hotspots ####
hotspots <- denmex::den_hotspots[loc, ]

# Step 3. Vizualization of hotspots ####

hotspots |>
    denhotspots::staticmap_intensity(pal = rcartocolor::carto_pal,
                                 pal_name = TRUE,
                                 name = "OrYel",
                                 breaks = 1,
                                 dir_pal = -1,
                                 x_leg = 0.5,
                                 y_leg = 0.1,
                                 ageb = TRUE)
```
:::

::: grid-item
```{r hotspots_vector_guadalajara, out.height="110%", out.width="110%"}
source("/Users/fdzul/Dropbox/r_developments/r_talks/2023/reunion_interstatal_2023/reunion_quintana_roo/functions/intensity_eggs.R")

denmex::eggs_betas_14_jalisco |>
    dplyr::filter(year == 2019) |>
    intensity_eggs(locality = c("Guadalajara",
                                "Tlaquepaque",
                                "Tonalá",
                                "Zapopan"),
                    cve_ent = "14",
                    palette = rcartocolor::carto_pal,
                    name = "SunsetDark")



```
:::

::: grid-item
```{r risk_guadalajara, out.height="110%", out.width="110%"}
# Step 1. calculate the risk ####
risk <- denhotspots::risk_ageb(betas = denmex::eggs_betas_14_jalisco,
                               hotspots = denmex::den_hotspots,
                               intensity_perc = 25,
                               locality = c("Guadalajara",
                                              "Tlaquepaque",
                                              "Tonalá",
                                              "Zapopan"),
                               cve_edo = "14")

# Step 2. map ####
denhotspots::map_risk(risk = risk,
                      staticmap = TRUE)
```
:::

:::


</body>
</html>


## [Definición de los Escenarios Operativos ó Epidemiológicos]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">


:::: {.columns}

::: {.column style="width: 50%"}
Concepto
<img src = "transmision_persistente.jpg">
:::

:::{.column style="width: 50%"}
Mapa de riesgo
<img src = "https://github.com/fdzul/spatial_analysis_dengue_R_2024_talks/blob/main/talks/spatial_analysis_dengue/fig/map_risk_guadalajara.jpg?raw=true">
:::

::::



## [Definición de los Escenarios Operativos ó Epidemiológicos]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

:::: {.columns}

::: {.column style="width: 40%;font-size: 70%"}

<span style="color:#F44B1FFF;">Áreas con riesgo muy alto de transmisión.</span> Hotposts de casos + hotspots del vector.

<span style="color:#FF9000FF;">Áreas con riesgo alto de transmisión.</span> Hotspots de transmisión.

<span style="color:gold;">Áreas con riesgo medio de transmisión.</span>Hotspots del vector.

<span style="color:#00F293FF;">Áreas con riesgo alto de transmisión.</span>Sin hotspots de transmisión o hotspots del vector.

:::

::: {.column style="width: 60%"}
```{r risk_merida2}
#| fig-width: 8
#| fig-height: 8
# Step 1. calculate the risk ####
risk <- denhotspots::risk_ageb(betas = denmex::eggs_betas_31_yucatan,
                               hotspots = denmex::den_hotspots,
                               intensity_perc = 25,
                               locality = "Mérida",
                               cve_edo = "31")

# Step 2. map ####
denhotspots::map_risk(risk = risk,
                      staticmap = TRUE)
```
:::

::::

## [Transmisión Activa & Abundancia reciente]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

<html>
<head>
```{=html}
<style>
.grid-container {
  display: grid;
  grid-template-columns: auto auto auto auto;
  padding: 5px;
}

.grid-item {
  background-color: rgba(255, 255, 255, 0.8);
  border: 1px solid rgba(0, 0, 0, 0.8);
  padding: 5px;
  font-size: 30px;
  text-align: center;
}
</style>
```
</head>
<body>
<h1>
</h1>
<p>
</p>

::: grid-container

::: grid-item
Localidad
:::

::: grid-item
Transmisión
:::

::: grid-item
Vector
:::

::: grid-item
Escenarios
:::

::: grid-item
Mérida
:::

::: grid-item
```{r}
#| echo: false
#| output: true
# Step 1. load the dengue dataset geocoded ####
load("/Users/fdzul/Library/CloudStorage/OneDrive-Personal/proyects/geocoding_mex/2024/8.RData/denmex_2024.RData")


########
densnv::mp_heatmap(locality = "Merida",
                   cve_edo = "31",
                   geocoded_datasets = z,
                   zoom = 12,
                   status_caso = c(1, 2),
                   week = c(1:6),
                   alpha = 0.3,
                   static = TRUE,
                   map_type = "terrain")
```

:::

::: grid-item
```{r}
#| echo: false
#| output: true
path_ovitraps <- "/Users/fdzul/Dropbox/CENAPRECE/2024/31_yucatan"
path_coord <- paste(path_ovitraps,"DescargaOvitrampasMesFco.txt", sep = "/" )
x <- deneggs::eggs_hotspots(path_lect = path_ovitraps,
                            cve_ent = "31",
                            locality  = "Mérida",
                            path_coord = path_coord,
                            longitude  = "Pocision_X",
                            latitude =  "Pocision_Y",
                            aproximation = "gaussian",
                            integration = "eb",
                            fam = "zeroinflatednbinomial1",
                            k = 80,
                            palette_vir  = "viridis",
                            leg_title = "Huevos",
                            plot = FALSE,
                            hist_dataset = FALSE,
                            sem = 4,
                            var = "eggs",
                            cell_size = 3000,
                            alpha = .99)
x$map +
    ggplot2::theme(legend.position = "none")
```

:::

::: grid-item
```{r}
#| echo: false
#| output: true
# Step 1. load the dengue dataset geocoded ####
load("/Users/fdzul/Library/CloudStorage/OneDrive-Personal/proyects/geocoding_mex/2024/8.RData/denmex_2024.RData")
# Step 1. transform dataset #####
w <- z |>
    dplyr::filter(ESTATUS_CASO %in% c(1, 2)) |>
    dplyr::mutate(x = long,
                  y = lat) |>
    sf::st_as_sf(coords = c("long", "lat"),
                 crs = 4326)

# Step 2. extract the locality ####
locality <- rgeomex::extract_locality(cve_edo = "31",
                                      locality = "Merida")

# Step 3. extract the geocoded cases of merida ####
w <- w[locality, ]  |>
    #sf::st_drop_geometry() |>
    dplyr::filter(SEM %in% c(1:6))

x$map +
    ggnewscale::new_scale_fill() +
    ggplot2::stat_density_2d(data = w,
                             ggplot2::aes(x = x,
                                          y = y),
                             geom = "density_2d", #"polygon",
                             col = "white", # "#E01E5A"
                             lwd = 0.3,
                             alpha = 0.7) +
    ggplot2::geom_point(data = w |>
                            dplyr::filter(ESTATUS_CASO %in% c(1, 2)), 
                        ggplot2::aes(x = x,
                                     y = y),
                        alpha = 0.3,
                        col = "#E01E5A") +
    ggplot2::theme(legend.position = "none")

```

:::

::: grid-item
Guadalajara
:::

::: grid-item
```{r}
#| echo: false
#| output: true
# Step 1. load the dengue dataset geocoded ####
load("/Users/fdzul/Library/CloudStorage/OneDrive-Personal/proyects/geocoding_mex/2024/8.RData/denmex_2024.RData")


########
densnv::mp_heatmap(locality = c("Guadalajara",
                                              "Tlaquepaque",
                                              "Tonalá",
                                              "Zapopan"),
                   cve_edo = "14",
                   geocoded_datasets = z,
                   zoom = 12,
                   status_caso = c(1, 2),
                   week = c(1:6),
                   alpha = 0.3,
                   static = TRUE,
                   map_type = "terrain")
```

:::

::: grid-item
```{r}
#| echo: false
#| output: true
path_ovitraps <- "/Users/fdzul/Dropbox/CENAPRECE/2024/14_jalisco"
path_coord <- paste(path_ovitraps,"DescargaOvitrampasMesFco.txt", sep = "/" )
y <- deneggs::eggs_hotspots(path_lect = path_ovitraps,
                            cve_ent = "14",
                            locality  = c("Guadalajara",
                                              "Tlaquepaque",
                                              "Tonalá",
                                              "Zapopan"),
                            path_coord = path_coord,
                            longitude  = "Pocision_X",
                            latitude =  "Pocision_Y",
                            aproximation = "gaussian",
                            integration = "eb",
                            fam = "zeroinflatednbinomial1",
                            k = 80,
                            palette_vir  = "viridis",
                            leg_title = "Huevos",
                            plot = FALSE,
                            hist_dataset = FALSE,
                            sem = 4,
                            var = "eggs",
                            cell_size = 3000,
                            alpha = .99)
y$map +
    ggplot2::theme(legend.position = "none")
```

:::

::: grid-item
```{r}
#| echo: false
#| output: true
# Step 1. load the dengue dataset geocoded ####
load("/Users/fdzul/Library/CloudStorage/OneDrive-Personal/proyects/geocoding_mex/2024/8.RData/denmex_2024.RData")
# Step 1. transform dataset #####
w <- z |>
    dplyr::filter(ESTATUS_CASO %in% c(1, 2)) |>
    dplyr::mutate(x = long,
                  y = lat) |>
    sf::st_as_sf(coords = c("long", "lat"),
                 crs = 4326)

# Step 2. extract the locality ####
locality <- rgeomex::extract_locality(cve_edo = "14",
                                      locality = c("Guadalajara",
                                              "Tlaquepaque",
                                              "Tonalá",
                                              "Zapopan"))

# Step 3. extract the geocoded cases of merida ####
w <- w[locality, ]  |>
    #sf::st_drop_geometry() |>
    dplyr::filter(SEM %in% c(1:6))

y$map +
    ggnewscale::new_scale_fill() +
    ggplot2::stat_density_2d(data = w,
                             ggplot2::aes(x = x,
                                          y = y),
                             geom = "density_2d", #"polygon",
                             col = "white", # "#E01E5A"
                             lwd = 0.3,
                             alpha = 0.7) +
    ggplot2::geom_point(data = w |>
                            dplyr::filter(ESTATUS_CASO %in% c(1, 2)), 
                        ggplot2::aes(x = x,
                                     y = y),
                        alpha = 0.3,
                        col = "#E01E5A") +
    ggplot2::theme(legend.position = "none")

```

:::

:::

</body>
</html>

## [Definición de los Escenarios Operativos ó Epidemiológicos]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

:::: {.columns}

::: {.column style="width: 40%;font-size: 70%"}
Concepto
<img src = "transmision_activa.jpg">

:::

::: {.column style="width: 60%"}
```{r heatmap_merida1}
#| fig-width: 8
#| fig-height: 8
# Step 1. load the dengue dataset geocoded ####
load("/Users/fdzul/Library/CloudStorage/OneDrive-Personal/proyects/geocoding_mex/2024/8.RData/denmex_2024.RData")
# Step 1. transform dataset #####
w <- z |>
    dplyr::filter(ESTATUS_CASO %in% c(1, 2)) |>
    dplyr::mutate(x = long,
                  y = lat) |>
    sf::st_as_sf(coords = c("long", "lat"),
                 crs = 4326)

# Step 2. extract the locality ####
locality <- rgeomex::extract_locality(cve_edo = "31",
                                      locality = "Merida")

# Step 3. extract the geocoded cases of merida ####
w <- w[locality, ]  |>
    #sf::st_drop_geometry() |>
    dplyr::filter(SEM %in% c(1:6))

x$map +
    ggnewscale::new_scale_fill() +
    ggplot2::stat_density_2d(data = w,
                             ggplot2::aes(x = x,
                                          y = y),
                             geom = "density_2d", #"polygon",
                             col = "white", # "#E01E5A"
                             lwd = 0.3,
                             alpha = 0.7) +
    ggplot2::geom_point(data = w |>
                            dplyr::filter(ESTATUS_CASO %in% c(1, 2)), 
                        ggplot2::aes(x = x,
                                     y = y),
                        alpha = 0.3,
                        col = "#E01E5A") +
    ggplot2::theme(legend.position = "none")

```
:::

::::

## [Definición de los Escenarios Operativos ó Epidemiológicos]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

:::: {.columns}

::: {.column style="width: 40%;font-size: 70%"}
<span style="color:#F44B1FFF;">Área caliente.</span>Área donde de concentra la mayor cantidad de casos y es mayor la intensidad de la abundancia del vector

:::

::: {.column style="width: 60%"}
```{r heatmap_merida2}
#| fig-width: 8
#| fig-height: 8
# Step 1. load the dengue dataset geocoded ####
load("/Users/fdzul/Library/CloudStorage/OneDrive-Personal/proyects/geocoding_mex/2024/8.RData/denmex_2024.RData")
# Step 1. transform dataset #####
w <- z |>
    dplyr::filter(ESTATUS_CASO %in% c(1, 2)) |>
    dplyr::mutate(x = long,
                  y = lat) |>
    sf::st_as_sf(coords = c("long", "lat"),
                 crs = 4326)

# Step 2. extract the locality ####
locality <- rgeomex::extract_locality(cve_edo = "31",
                                      locality = "Merida")

# Step 3. extract the geocoded cases of merida ####
w <- w[locality, ]  |>
    #sf::st_drop_geometry() |>
    dplyr::filter(SEM %in% c(1:6))

x$map +
    ggnewscale::new_scale_fill() +
    ggplot2::stat_density_2d(data = w,
                             ggplot2::aes(x = x,
                                          y = y),
                             geom = "density_2d", #"polygon",
                             col = "white", # "#E01E5A"
                             lwd = 0.3,
                             alpha = 0.7) +
    ggplot2::geom_point(data = w |>
                            dplyr::filter(ESTATUS_CASO %in% c(1, 2)), 
                        ggplot2::aes(x = x,
                                     y = y),
                        alpha = 0.3,
                        col = "#E01E5A") +
    ggplot2::theme(legend.position = "none")

```
:::

::::


## [Biología del Vector del Dengue]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

![](life_cycle_culicidae.png){fig-align="center"width=70%}

## [Manejo Integrado de las Arbovirosis en México]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Step 1. load the dataset #####
load("/Users/fdzul/Library/CloudStorage/OneDrive-Personal/automatic_read_sinave/8.RData/epid_channel_data.RData")

# Step 2. extract the dengue cases of veracruz ####
x <- x |>
    dplyr::filter(DES_EDO_RES == "VERACRUZ") 

y <- tibble::tibble(SEM = x$SEM,
                    y = x$q25,
                    arm = "Nuevo Paradigma")
prob <- tibble::tibble(SEM = x$SEM,
                       prob = rep(0, length(x$SEM)))

# plot risk stratificaction  #####
ggplot2::ggplot() +
    ggplot2::geom_rect(ggplot2::aes(xmin = c(-Inf, 25), 
                                    xmax = c(25, Inf), 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = c("#2EB67D", "#E01E5A"),
                       alpha = .2) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 20, 
                                    xmax = 25, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "orange",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 25, 
                                    xmax = 27, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "gray",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 38, 
                                    xmax = 40, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "#E01E5A",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 40, 
                                    xmax = 42, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "gray",
                       alpha = 0.8) +
    ggplot2::geom_vline(xintercept = 25,
                        color = "gray", #"#36C5F0",
                        size = 1,
                        linetype = 3) +
    ggplot2::geom_vline(xintercept = 20,
                        color = "gray", #"#36C5F0",
                        size = 1,
                        linetype = 3) +
    ggplot2::geom_line(data = x, 
                       ggplot2::aes(x = SEM,
                                    y = q75-10),
                       col = "#E01E5A",
                       size = 3) +
    ggplot2::geom_line(data = y, 
                       ggplot2::aes(x = SEM,
                                    y = y),
                       color = "#2EB67D", #"#36C5F0",
                       size = 3) +
    ggplot2::scale_x_continuous(breaks = seq(from = min(y$SEM), to = max(y$SEM), by = 4))+
    ggplot2::ylab("Número de Casos") +
    ggplot2::xlab("Semanas Epidemiológicas") +
    ggplot2::annotate("text",
                      label = "Control Proactivo",
                      x = 10, 
                      y = 450,
                      #text = "risk",
                      col = "#2EB67D",
                      size = 6) +
    ggplot2::annotate("text",
                      label = "Escenarios Operativos \nbasados \nen \nTransmisión Persistente",
                      x = 10, 
                      y = 380,
                      #text = "risk",
                      col = "#2EB67D",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Control Reactivo",
                      x = 47, 
                      y = 450,
                      #text = "risk",
                      col = "#E01E5A",
                      size = 6) +
    ggplot2::annotate("text",
                      label = "Escenarios Operativos \nbasados \nen \nTransmisión Activa",
                      x = 47, 
                      y = 380,
                      #text = "risk",
                      col = "#E01E5A",
                      size = 4) +
    ggplot2::geom_line(data = prob, 
                       ggplot2::aes(x = SEM,
                                    y = prob),
                       color = "#36C5F0",
                       size = 2)  +
    ggplot2::annotate("text",
                      label = "Acciones Específicas Básicas",
                      x = 10, 
                      y = 280,
                      col = "gray",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Vigilancia Epidemiológica y Entomológica",
                      x = 10, 
                      y = 250,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Control de Probables",
                      x = 10, 
                      y = 230,
                      col = "#36C5F0",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "Hotspots del Vector",
                      x = 10, 
                      y = 200,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Acciones Específicas de Soporte",
                      x = 10, 
                      y = 150,
                      col = "gray",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Termonebulización,\n Nebulización, & \nEliminación Masiva de Criaderos",
                      x = 10, 
                      y = 110,
                      col = "gray",
                      size = 3) +
  ggplot2::annotate("text",
                      label = "Sin Control",
                      x = 30, 
                      y = 425,
                      #text = "risk",
                      col = "#E01E5A",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "Con Control",
                      x = 35, 
                      y = 105,
                      col = "#2EB67D",
                      size = 4) +
  ggplot2::annotate(geom ="text",
                      label = "Rociado Residual Intradomiciliario & Control Larvario",
                      x = 22, 
                      y = 220,
                    angle = 90,
                      col = "white",
                      size = 4) +
    ggplot2::annotate(geom ="text",
                      label = "ULV Fria o Caliente",
                      x = 26, 
                      y = 220,
                      angle = 90,
                      col = "white",
                      size = 4) +
  ggplot2::annotate(geom ="text",
                      label = "Control Larvario",
                      x = 39, 
                      y = 220,
                    angle = 90,
                      col = "white",
                      size = 4) +
    ggplot2::annotate(geom ="text",
                      label = "ULV Fria o Caliente",
                      x = 41, 
                      y = 220,
                      angle = 90,
                      col = "white",
                      size = 4)

```


## [Manejo Integrado de las Arbovirosis en México]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

![](escenarios_ento.png)

## [Localidades sin Transmision Epidémica en el Primer Semestre]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Step 1. load the dataset #####
load("/Users/fdzul/Library/CloudStorage/OneDrive-Personal/automatic_read_sinave/8.RData/epid_channel_data.RData")

# Step 2. extract the dengue cases of veracruz ####
x <- x |>
    dplyr::filter(DES_EDO_RES == "VERACRUZ") 

y <- tibble::tibble(SEM = x$SEM,
                    y = x$q25,
                    arm = "Nuevo Paradigma")
prob <- tibble::tibble(SEM = x$SEM,
                       prob = rep(0, length(x$SEM)))

# plot risk stratificaction  #####
ggplot2::ggplot() +
    ggplot2::geom_rect(ggplot2::aes(xmin = c(-Inf, 25), 
                                    xmax = c(25, Inf), 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = c("#2EB67D", "#2EB67D"),
                       alpha = .2) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 20, 
                                    xmax = 25, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "orange",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 25, 
                                    xmax = 27, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "gray40",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 38, 
                                    xmax = 40, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "#E01E5A",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 40, 
                                    xmax = 42, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "gray40",
                       alpha = 0.8) +
    ggplot2::geom_vline(xintercept = 25,
                        color = "gray", #"#36C5F0",
                        size = 1,
                        linetype = 3) +
    ggplot2::geom_vline(xintercept = 20,
                        color = "gray40", #"#36C5F0",
                        size = 1,
                        linetype = 3) +
    ggplot2::geom_line(data = y, 
                       ggplot2::aes(x = SEM,
                                    y = y),
                       color = "#2EB67D", #"#36C5F0",
                       size = 3) +
    ggplot2::scale_x_continuous(breaks = seq(from = min(y$SEM), to = max(y$SEM), by = 4))+
    ggplot2::ylab("Número de Casos") +
    ggplot2::xlab("Semanas Epidemiológicas") +
    ggplot2::annotate("text",
                      label = "Control Proactivo",
                      x = 10, 
                      y = 450,
                      #text = "risk",
                      col = "#2EB67D",
                      size = 6) +
    ggplot2::annotate("text",
                      label = "Escenarios Operativos \nbasados \nen \nTransmisión Persistente",
                      x = 10, 
                      y = 380,
                      #text = "risk",
                      col = "#2EB67D",
                      size = 4) +
    ggplot2::geom_line(data = prob, 
                       ggplot2::aes(x = SEM,
                                    y = prob),
                       color = "#36C5F0",
                       size = 2)  +
    ggplot2::annotate("text",
                      label = "Acciones Específicas Básicas",
                      x = 10, 
                      y = 280,
                      col = "gray40",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Vigilancia Epidemiológica y Entomológica",
                      x = 10, 
                      y = 250,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Control de Probables",
                      x = 10, 
                      y = 230,
                      col = "#36C5F0",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "Hotspots del Vector",
                      x = 10, 
                      y = 200,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Acciones Específicas de Soporte",
                      x = 10, 
                      y = 150,
                      col = "gray40",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Termonebulización,\n Nebulización, & \nEliminación Masiva de Criaderos",
                      x = 10, 
                      y = 110,
                      col = "gray40",
                      size = 3) +
  ggplot2::annotate("text",
                      label = "Con Control",
                      x = 35, 
                      y = 105,
                      col = "#2EB67D",
                      size = 4) +
  ggplot2::annotate(geom ="text",
                      label = "Rociado Residual Intradomiciliario & Control Larvario",
                      x = 22, 
                      y = 220,
                    angle = 90,
                      col = "white",
                      size = 4) +
    ggplot2::annotate(geom ="text",
                      label = "ULV Fria o Caliente",
                      x = 26, 
                      y = 220,
                      angle = 90,
                      col = "white",
                      size = 4) +
  ggplot2::annotate(geom ="text",
                      label = "Control Larvario",
                      x = 39, 
                      y = 220,
                    angle = 90,
                      col = "white",
                      size = 4) +
    ggplot2::annotate(geom ="text",
                      label = "ULV Fria o Caliente",
                      x = 41, 
                      y = 220,
                      angle = 90,
                      col = "white",
                      size = 4)

```


## [Localidades con Transmision Epidémica en el Segundo Semestre]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">


```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Step 1. load the dataset #####
load("/Users/fdzul/Library/CloudStorage/OneDrive-Personal/automatic_read_sinave/8.RData/epid_channel_data.RData")

# Step 2. extract the dengue cases of veracruz ####
x <- x |>
    dplyr::filter(DES_EDO_RES == "VERACRUZ") 

y <- tibble::tibble(SEM = x$SEM,
                    y = x$q25,
                    arm = "Nuevo Paradigma")
prob <- tibble::tibble(SEM = x$SEM,
                       prob = rep(0, length(x$SEM)))

# plot risk stratificaction  #####
ggplot2::ggplot() +
    ggplot2::geom_rect(ggplot2::aes(xmin = c(-Inf, 25), 
                                    xmax = c(25, Inf), 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = c("#2EB67D", "#E01E5A"),
                       alpha = .2) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 20, 
                                    xmax = 25, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "orange",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 25, 
                                    xmax = 27, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "gray40",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 38, 
                                    xmax = 40, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "#E01E5A",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 40, 
                                    xmax = 42, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "gray40",
                       alpha = 0.8) +
    ggplot2::geom_vline(xintercept = 25,
                        color = "gray40", #"#36C5F0",
                        size = 1,
                        linetype = 3) +
    ggplot2::geom_vline(xintercept = 20,
                        color = "gray40", #"#36C5F0",
                        size = 1,
                        linetype = 3) +
    ggplot2::geom_line(data = x, 
                       ggplot2::aes(x = SEM,
                                    y = q75-10),
                       col = "#E01E5A",
                       size = 3) +
    ggplot2::scale_x_continuous(breaks = seq(from = min(y$SEM), to = max(y$SEM), by = 4))+
    ggplot2::ylab("Número de Casos") +
    ggplot2::xlab("Semanas Epidemiológicas") +
    ggplot2::annotate("text",
                      label = "Control Proactivo",
                      x = 10, 
                      y = 450,
                      #text = "risk",
                      col = "#2EB67D",
                      size = 6) +
    ggplot2::annotate("text",
                      label = "Escenarios Operativos \nbasados \nen \nTransmisión Persistente",
                      x = 10, 
                      y = 380,
                      #text = "risk",
                      col = "#2EB67D",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Control Reactivo",
                      x = 47, 
                      y = 450,
                      #text = "risk",
                      col = "#E01E5A",
                      size = 6) +
    ggplot2::annotate("text",
                      label = "Escenarios Operativos \nbasados \nen \nTransmisión Activa",
                      x = 47, 
                      y = 380,
                      #text = "risk",
                      col = "#E01E5A",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Acciones Específicas Básicas",
                      x = 10, 
                      y = 280,
                      col = "gray40",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Vigilancia Epidemiológica y Entomológica",
                      x = 10, 
                      y = 250,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Control de Probables",
                      x = 10, 
                      y = 230,
                      col = "#36C5F0",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "Hotspots del Vector",
                      x = 10, 
                      y = 200,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Acciones Específicas de Soporte",
                      x = 10, 
                      y = 150,
                      col = "gray40",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Termonebulización,\n Nebulización, & \nEliminación Masiva de Criaderos",
                      x = 10, 
                      y = 110,
                      col = "gray40",
                      size = 3) +
  ggplot2::annotate(geom ="text",
                      label = "Rociado Residual Intradomiciliario & Control Larvario",
                      x = 22, 
                      y = 220,
                    angle = 90,
                      col = "white",
                      size = 4) +
    ggplot2::annotate(geom ="text",
                      label = "ULV Fria o Caliente",
                      x = 26, 
                      y = 220,
                      angle = 90,
                      col = "white",
                      size = 4) +
  ggplot2::annotate(geom ="text",
                      label = "Control Larvario",
                      x = 39, 
                      y = 220,
                    angle = 90,
                      col = "white",
                      size = 4) +
    ggplot2::annotate(geom ="text",
                      label = "ULV Fria o Caliente",
                      x = 41, 
                      y = 220,
                      angle = 90,
                      col = "white",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "1. MegaOperativos o Barrido",
                      x = 33, 
                      y = 150,
                      col = "Black",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "ULV (4S)",
                      x = 32, 
                      y = 130,
                      col = "#E01E5A",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "Control Larvario",
                      x = 32, 
                      y = 110,
                      col = "#E01E5A",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "2. Operativo Focalizado",
                      x = 49, 
                      y = 300,
                      col = "black",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "Termo (4S) Alto Riesgo",
                      x = 49, 
                      y = 280,
                      col = "#E01E5A",
                      size = 4) +
  ggplot2::annotate("text",
                      label = "Termo SCM",
                      x = 49, 
                      y = 260,
                      col = "#E01E5A",
                      size = 4)

```


## [Localidades con Transmision Epidémica en el Primer Semestre]{.r-fit-text style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

```{r}
load("/Users/fdzul/Library/CloudStorage/OneDrive-Personal/automatic_read_sinave/8.RData/epid_channel_data.RData")

# Step 2. extract the dengue cases of veracruz ####
x <- x |>
    dplyr::filter(DES_EDO_RES == "VERACRUZ") 

y <- tibble::tibble(SEM = x$SEM,
                    y = x$q25,
                    arm = "Nuevo Paradigma")
#prob <- tibble::tibble(SEM = x$SEM,
#                       prob = rep(0, length(x$SEM)))


sim_a <- x |>
    dplyr::filter(SEM >= 26) |>
    dplyr::arrange(SEM) |>
    dplyr::mutate(sem = 1:28) |>
    dplyr::select(sem, q75)
sim_b <- tibble::tibble(sem = 28:53,
                        q75 = rnorm(n = length(28:53),
                                  mean = 29,
                                  sd = 1))

# plot risk stratificaction  #####
ggplot2::ggplot() +
    ggplot2::geom_rect(ggplot2::aes(xmin = c(-Inf, 25), 
                                    xmax = c(25, Inf), 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = c("#E01E5A", "#2EB67D"),
                       alpha = .2) +
    ggplot2::geom_line(data = sim_a, 
                       ggplot2::aes(x = sem,
                                    y = q75-10),
                       col = "#E01E5A",
                       size = 3) +
    ggplot2::geom_line(data = sim_b, 
                       ggplot2::aes(x = sem,
                                    y = q75-10),
                       col = "#2EB67D",
                       size = 3) +
    ggplot2::scale_x_continuous(breaks = seq(from = min(y$SEM),
                                             to = max(y$SEM), 
                                             by = 4)) +
    ggplot2::ylab("Número de Casos") +
    ggplot2::xlab("Semanas Epidemiológicas") +
    ggplot2::annotate("text",
                      label = "Control Proactivo",
                      x = 40, 
                      y = 450,
                      #text = "risk",
                      col = "#2EB67D",
                      size = 6) +
    ggplot2::annotate("text",
                      label = "Control Reactivo",
                      x = 10, 
                      y = 450,
                      #text = "risk",
                      col = "#E01E5A",
                      size = 6) +
    ggplot2::annotate("text",
                      label = "Acciones Específicas Básicas",
                      x = 40, 
                      y = 310,
                      col = "gray40",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Vigilancia Epidemiológica y Entomológica",
                      x = 25, 
                      y = 400,
                      col = "black",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Control de Probables",
                      x = 40, 
                      y = 280,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Áreas de riesgo",
                      x = 40, 
                      y = 240,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Hotspots del Vector",
                      x = 40, 
                      y = 260,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "1. MegaOperativos o Barridos",
                      x = 12, 
                      y = 200,
                      col = "Black",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "ULV (4S)",
                      x = 10, 
                      y = 180,
                      col = "#E01E5A",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Control Larvario (4S-6S)",
                      x = 10, 
                      y = 160,
                      col = "#E01E5A",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "2. Operativo Focalizado",
                      x = 10, 
                      y = 100,
                      col = "black",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Termo (4S) Alto Riesgo",
                      x = 10, 
                      y = 80,
                      col = "#E01E5A",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Termo SCM",
                      x = 10, 
                      y = 60,
                      col = "#E01E5A",
                      size = 4)
```





## [Directrices Internacionales]{style="color:#003300"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

[Global strategic framework for integrated vector management](https://www.who.int/publications/i/item/WHO-CDS-CPE-PVC-2004.10)

[Handbok for Integrated Vector Management](https://www.who.int/publications/i/item/9789241502801)

[Handbook for Integrated Vector Management in the Americas](https://iris.paho.org/handle/10665.2/51759)

[Best Practices for Integrated Mosquito Management](https://www.mosquito.org/assets/pdf/hr_november_2021_amca_bmp_ma/)

[AMCA's Best Practices for Integrated Mosquito Management Virtual Training Program](https://amca.ce21.com/item/best-practices-mosquito-management)

## [Dios Botic]{style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

-   ***Bio*** : [https://fdzul.github.io/web_site_fadm/]()

-   ***email*** : [felipe.dzul.m\@gmail.com]()

-   ***celular*** : [9999580167]()

-   ***slides***: [https://calm-hummingbird-41cb33.netlify.app/talks/mia/#/](https://calm-hummingbird-41cb33.netlify.app/talks/mia/#/)